<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Imposition Inspector - Toggle Fix</title>
<style>
  /* ========================================= */
  /* üé® THEME & VARIABLES */
  /* ========================================= */
  :root {
    --bg-panel: #0f172a;
    --bg-sheet: #334155;
    --bg-page: #f8fafc;
    --neon-pink: #FF79C9;
    --neon-blue: #3b82f6;
    --neon-orange: #f97316;
    --tech-cyan: #00ffff;
    --text-main: #e2e8f0;
    --font-mono: 'Courier New', monospace;
    
    /* FOLD COLORS */
    --fold-1-purple: #a855f7;
    --fold-2-pink: #ec4899;
    --fold-3-orange: #f59e0b;
    --collation-color: #000;
  }

  body {
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
    background: transparent;
    display: flex;
    justify-content: center;
    align-items: center;
    min-height: 100vh;
    margin: 0;
    padding: 0;
    overflow: hidden;
  }

  /* ========================================= */
  /* üì¶ WIDGET CONTAINER */
  /* ========================================= */
  .imposition-widget {
    background-color: var(--bg-panel);
    width: 100%;
    max-width: 850px;
    border-radius: 12px;
    box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.5);
    overflow: hidden;
    border: 1px solid #1e293b;
    position: relative;
    user-select: none;
  }

  /* HEADER */
  .widget-header {
    display: flex; justify-content: space-between; align-items: center;
    padding: 16px 20px; border-bottom: 1px solid #1e293b;
    background: rgba(15, 23, 42, 0.95);
  }

  .header-left { display: flex; flex-direction: column; gap: 4px; }

  .widget-title {
    color: var(--text-main); font-size: 14px; font-weight: 600;
    text-transform: uppercase; letter-spacing: 1px;
    display: flex; align-items: center; gap: 8px;
  }
  .widget-title::before {
    content: ''; display: block; width: 8px; height: 8px;
    background: var(--neon-pink); border-radius: 50%; box-shadow: 0 0 8px var(--neon-pink);
  }

  .scheme-name {
    font-family: var(--font-mono); font-size: 11px; color: #94a3b8;
    background: rgba(255,255,255,0.05); padding: 2px 6px;
    border-radius: 4px; border: 1px solid #334155;
  }

  /* CONTROLS */
  .controls-right { display: flex; align-items: center; gap: 16px; }

  .view-switch {
    display: flex; background: #1e293b; border-radius: 6px; padding: 2px; border: 1px solid #334155;
  }
  .view-btn {
    background: transparent; border: none; color: #94a3b8; font-size: 11px; font-weight: 600;
    padding: 6px 14px; cursor: pointer; border-radius: 4px; transition: all 0.2s;
  }
  .view-btn.active-front {
    background: rgba(59, 130, 246, 0.2); color: var(--neon-blue); box-shadow: 0 0 10px rgba(59, 130, 246, 0.1);
  }
  .view-btn.active-back {
    background: rgba(249, 115, 22, 0.2); color: var(--neon-orange); box-shadow: 0 0 10px rgba(249, 115, 22, 0.1);
  }

  /* Dim Toggle */
  .dim-toggle-wrapper {
    display: flex; align-items: center; gap: 8px; font-size: 10px; color: #64748b; font-family: var(--font-mono);
  }
  .switch { position: relative; display: inline-block; width: 32px; height: 16px; }
  .switch input { opacity: 0; width: 0; height: 0; }
  .slider {
    position: absolute; cursor: pointer; top: 0; left: 0; right: 0; bottom: 0;
    background-color: #334155; transition: .4s; border-radius: 20px;
  }
  .slider:before {
    position: absolute; content: ""; height: 10px; width: 10px; left: 3px; bottom: 3px;
    background-color: white; transition: .4s; border-radius: 50%;
  }
  input:checked + .slider { background-color: var(--neon-pink); }
  input:checked + .slider:before { transform: translateX(16px); }


  /* ========================================= */
  /* üìÑ THE SHEET (VIEWPORT) */
  /* ========================================= */
  .viewport {
    padding: 40px 20px;
    display: flex; justify-content: center; align-items: center;
    background-image: radial-gradient(#1e293b 1px, transparent 1px);
    background-size: 20px 20px;
    position: relative; perspective: 1200px;
  }

  .sheet {
    background-color: var(--bg-sheet);
    width: 600px; height: 420px; 
    padding: 15px; 
    position: relative;
    box-shadow: 0 15px 40px rgba(0,0,0,0.4);
    transition: transform 0.6s cubic-bezier(0.4, 0.0, 0.2, 1);
    transform-style: preserve-3d;
  }

  .print-area {
    width: 100%; height: 100%; position: relative;
  }

  /* FLIP ANIMATION */
  .imposition-widget.view-back .sheet { animation: flipSheet 0.5s ease-in-out; }
  @keyframes flipSheet {
    0% { transform: scale(1); }
    50% { transform: scale(0.92) rotateY(15deg); }
    100% { transform: scale(1); }
  }

  /* 4x2 GRID */
  .imposition-grid {
    display: grid;
    grid-template-columns: repeat(4, 1fr);
    grid-template-rows: repeat(2, 1fr);
    gap: 0; 
    width: 100%; height: 100%;
    position: relative;
    outline: 1px dashed rgba(255,255,255,0.1);
  }

  /* PAGE ITEM */
  .page {
    background-color: var(--bg-page);
    position: relative; cursor: crosshair; transition: all 0.2s ease;
    display: flex; flex-direction: column; justify-content: center; align-items: center;
    font-family: var(--font-mono); color: #94a3b8; overflow: hidden; font-size: 10px;
    outline: 1px solid rgba(0,0,0,0.05); 
  }

  .page-num { font-size: 32px; font-weight: bold; color: #cbd5e1; z-index: 2; }
  .head-indicator { font-size: 9px; text-transform: uppercase; margin-top: 4px; opacity: 0.5; }

  /* ROTATION */
  .page.rotated .page-content { transform: rotate(180deg); }
  .page.rotated { background-color: #f1f5f9; border-bottom: 3px solid #cbd5e1; }
  .page:not(.rotated) { border-top: 3px solid #cbd5e1; }

  /* Highlight Page 1 */
  .page[data-page="1"] { background-color: rgba(16, 185, 129, 0.15); border-color: #10b981; }
  .page[data-page="1"] .page-num { color: #10b981; }

  /* Hover */
  .page:hover { box-shadow: inset 0 0 0 2px var(--neon-pink); z-index: 10; }
  .page:hover .page-num { color: var(--neon-pink); }


  /* ========================================= */
  /* üìè FOLD LINES (HIDDEN BY DEFAULT) */
  /* ========================================= */
  
  .fold-line {
    position: absolute; pointer-events: none; z-index: 20;
    display: flex; justify-content: center; align-items: center;
    /* Hidden by default */
    opacity: 0; transition: opacity 0.3s ease;
  }

  /* SHOW WHEN TOGGLED */
  .imposition-widget.show-dimensions .fold-line {
    opacity: 1;
  }

  .fold-label {
    background: var(--bg-panel); color: white;
    font-family: var(--font-mono); font-size: 10px; padding: 2px 5px;
    border-radius: 4px; font-weight: bold; box-shadow: 0 2px 4px rgba(0,0,0,0.3);
    white-space: nowrap;
  }

  /* FOLD 1 */
  .fold-1 {
    top: -15px; bottom: -15px; left: 50%; width: 2px;
    background: var(--fold-1-purple); transform: translateX(-50%);
  }
  .fold-1 .fold-label {
    position: absolute; top: -25px; color: var(--fold-1-purple); border: 1px solid var(--fold-1-purple);
  }

  /* FOLD 2 */
  .fold-2 {
    left: -15px; right: -15px; top: 50%; height: 2px;
    background: var(--fold-2-pink); transform: translateY(-50%);
  }
  .fold-2 .fold-label {
    position: absolute; left: 50%; transform: translate(-50%, -50%);
    color: var(--fold-2-pink); border: 1px solid var(--fold-2-pink);
  }

  /* FOLD 3 */
  .fold-3-left {
    top: -15px; bottom: -15px; left: 25%; width: 2px;
    background: var(--fold-3-orange); transform: translateX(-50%);
  }
  .fold-3-right {
    top: -15px; bottom: -15px; left: 75%; width: 2px;
    background: var(--fold-3-orange); transform: translateX(-50%);
  }
  .fold-3-center-label {
    position: absolute; bottom: -25px; left: 50%; transform: translateX(-50%);
    color: var(--fold-3-orange); border: 1px solid var(--fold-3-orange);
  }

  /* ========================================= */
  /* üîñ COLLATION MARK (HIDDEN BY DEFAULT) */
  /* ========================================= */
  
  .collation-mark-container {
    position: absolute;
    left: 75%; /* Spine of Page 1 */
    /* UPDATED POSITION: Near top of Page 1 (Page 1 starts at 50% top) */
    top: 55%; 
    z-index: 30; pointer-events: none; 
    /* Hidden by default */
    opacity: 0; transition: opacity 0.3s ease;
  }
  
  /* SHOW WHEN TOGGLED (AND on Front View) */
  .imposition-widget.show-dimensions:not(.view-back) .collation-mark-container {
      opacity: 1;
  }
  
  .collation-mark {
    width: 6px; height: 20px;
    background-color: var(--collation-color);
    margin-left: 2px; border-radius: 1px;
  }

  .collation-label {
      position: absolute; left: 12px; top: 2px;
      white-space: nowrap; font-size: 9px; font-weight: bold;
      color: var(--text-main); font-family: var(--font-mono);
      text-shadow: 0 1px 2px rgba(0,0,0,0.8);
  }


  /* ========================================= */
  /* üìè DIMENSIONS (HIDDEN BY DEFAULT) */
  /* ========================================= */
  .dim-layer { opacity: 0; transition: opacity 0.3s; pointer-events: none; position: absolute; inset: 0;}
  .show-dimensions .dim-layer { opacity: 1; }
  .dim-marker {
    position: absolute; font-family: var(--font-mono); font-size: 10px; color: white; opacity: 0.5;
    background: var(--bg-panel); padding: 2px 6px; border: 1px solid white; border-radius: 3px; white-space: nowrap;
  }

  /* TOOLTIP */
  .inspector-tooltip {
    position: fixed; background: rgba(15, 23, 42, 0.95); border: 1px solid var(--neon-pink);
    color: white; padding: 10px 14px; border-radius: 4px; font-family: var(--font-mono); font-size: 11px;
    pointer-events: none; opacity: 0; z-index: 100;
    box-shadow: 0 10px 25px rgba(0,0,0,0.6); transition: opacity 0.1s;
  }
  .tooltip-row { display: flex; justify-content: space-between; gap: 20px; margin-bottom: 4px; }
  .val-highlight { color: var(--neon-pink); font-weight: bold; }

</style>
</head>
<body>

<div class="imposition-widget" id="widget">
  
  <header class="widget-header">
    <div class="header-left">
      <div class="widget-title">Imposition Inspector</div>
      <div class="scheme-name" id="schemeLabel">16-Page Signature (JDF F16-7 Cross Fold)</div>
    </div>
    
    <div class="controls-right">
      <div class="view-switch">
        <button class="view-btn active-front" id="btnFront">Outer Form</button>
        <button class="view-btn" id="btnBack">Inner Form</button>
      </div>
      
      <div class="dim-toggle-wrapper">
        <span>SPECS</span>
        <label class="switch">
          <input type="checkbox" id="layerToggle">
          <span class="slider"></span>
        </label>
      </div>
    </div>
  </header>

  <div class="viewport">
    <div class="sheet">
      <div class="print-area">
        
        <div class="imposition-grid" id="gridContainer"></div>

        <div class="fold-line fold-1"><div class="fold-label">FOLD 1</div></div>

        <div class="fold-line fold-2"><div class="fold-label">FOLD 2</div></div>

        <div class="fold-line fold-3-left"></div>
        <div class="fold-line fold-3-right"></div>
        <div class="fold-line" style="bottom: -10px; left: 50%; width: 0; height: 0;">
           <div class="fold-label fold-3-center-label">FOLD 3</div>
        </div>

        <div class="collation-mark-container">
            <div class="collation-mark"></div>
            <div class="collation-label">Collation Mark</div>
        </div>

        <div class="dim-layer">
          <div class="dim-marker" style="top: -25px; right: 0;">1000 x 700 mm</div>
        </div>

      </div>
    </div>
  </div>

  <div class="inspector-tooltip" id="tooltip">
    <div class="tooltip-row"><span>Page:</span> <span id="tt-page" class="val-highlight">1</span></div>
    <div class="tooltip-row"><span>Head:</span> <span id="tt-orient">UP</span></div>
    <div class="tooltip-row"><span>Form:</span> <span id="tt-side">Outer</span></div>
  </div>

</div>

<script>
  // Configuration: JDF F16-7 (Standard Cross Fold)
  const impositionScheme = {
    front: [
      { page: 5, rotated: true },  { page: 12, rotated: true }, { page: 9, rotated: true },  { page: 8, rotated: true },
      { page: 4, rotated: false }, { page: 13, rotated: false }, { page: 16, rotated: false }, { page: 1, rotated: false }
    ],
    back: [
      { page: 7, rotated: true },  { page: 10, rotated: true }, { page: 11, rotated: true }, { page: 6, rotated: true },
      { page: 2, rotated: false }, { page: 15, rotated: false }, { page: 14, rotated: false }, { page: 3, rotated: false }
    ]
  };

  const grid = document.getElementById('gridContainer');
  const btnFront = document.getElementById('btnFront');
  const btnBack = document.getElementById('btnBack');
  const widget = document.getElementById('widget');
  const tooltip = document.getElementById('tooltip');
  
  const ttPage = document.getElementById('tt-page');
  const ttOrient = document.getElementById('tt-orient');
  const ttSide = document.getElementById('tt-side');

  let currentSide = 'front';

  function renderGrid(side) {
    grid.innerHTML = '';
    const data = impositionScheme[side];
    
    data.forEach(item => {
      const el = document.createElement('div');
      el.className = `page ${item.rotated ? 'rotated' : ''}`;
      el.setAttribute('data-page', item.page);
      
      el.innerHTML = `
        <div class="page-content">
          <div class="page-num">${item.page}</div>
          <div class="head-indicator">${item.rotated ? 'HEAD DOWN' : 'HEAD UP'}</div>
        </div>
      `;
      
      el.addEventListener('mouseenter', () => showTooltip(item, side));
      el.addEventListener('mousemove', moveTooltip);
      el.addEventListener('mouseleave', hideTooltip);
      
      grid.appendChild(el);
    });
  }

  function switchSide(side) {
    if(side === currentSide) return;
    currentSide = side;

    if(side === 'front') {
      btnFront.classList.add('active-front');
      btnBack.classList.remove('active-back');
      widget.classList.remove('view-back');
    } else {
      btnFront.classList.remove('active-front');
      btnBack.classList.add('active-back');
      widget.classList.add('view-back');
    }
    renderGrid(side);
  }

  function showTooltip(item, side) {
    ttPage.textContent = item.page;
    ttOrient.textContent = item.rotated ? 'DOWN' : 'UP';
    ttSide.textContent = side === 'front' ? 'Outer Form' : 'Inner Form';
    tooltip.style.opacity = '1';
  }

  function moveTooltip(e) {
    const x = e.clientX + 20;
    const y = e.clientY + 20;
    tooltip.style.top = `${y}px`;
    tooltip.style.left = `${x}px`;
  }

  function hideTooltip() {
    tooltip.style.opacity = '0';
  }

  btnFront.addEventListener('click', () => switchSide('front'));
  btnBack.addEventListener('click', () => switchSide('back'));
  
  document.getElementById('layerToggle').addEventListener('change', (e) => {
    e.target.checked ? widget.classList.add('show-dimensions') : widget.classList.remove('show-dimensions');
  });

  renderGrid('front');

</script>

</body>
</html>